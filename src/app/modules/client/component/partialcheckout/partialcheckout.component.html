<form [formGroup]="checkoutForm">
  <h3>Thông tin khách hàng</h3>

  <div *ngIf="!isSignedIn; else signedInBlock">
    <div class="form-group">
      <label>Họ tên khách hàng</label>
      <input formControlName="customerName" class="form-control" autocomplete="off" required />
    </div>
    <div class="form-group">
      <label>Số điện thoại</label>
      <input formControlName="phone" class="form-control" autocomplete="off" />
    </div>
    <div class="form-group">
      <label>Địa chỉ</label>
      <input formControlName="address" class="form-control" autocomplete="off" />
    </div>
    <div class="form-group">
      <label>Email</label>
      <input formControlName="email" class="form-control" autocomplete="off" />
    </div>
  </div>

  <ng-template #signedInBlock>
    <div class="form-group">
      <label>Họ tên khách hàng</label>
      <input
        formControlName="customerName"
        class="form-control"
        [value]="user?.userName"
        autocomplete="off"
        required
      />
    </div>
    <div class="form-group">
      <label>Số điện thoại</label>
      <input
        formControlName="phone"
        class="form-control"
        [value]="user?.phoneNumber"
        autocomplete="off"
      />
    </div>
    <div class="form-group">
      <label>Địa chỉ</label>
      <div>
        <label for="province">Province:</label>
        <select
          id="province"
          formControlName="province"
          (change)="onProvinceChange()"
          class="form-control"
        >
          <option value="">Select Province</option>
          <option *ngFor="let province of provinces" [value]="province.code">
            {{ province.name }}
          </option>
        </select>
      </div>

      <div>
        <label for="district">District:</label>
        <select
          id="district"
          formControlName="district"
          (change)="onDistrictChange()"
          [disabled]="!districts.length"
          class="form-control"
        >
          <option value="">Select District</option>
          <option *ngFor="let district of districts" [value]="district.code">
            {{ district.name }}
          </option>
        </select>
      </div>

      <div>
        <label for="ward">Ward:</label>
        <select id="ward" formControlName="ward" [disabled]="!wards.length" class="form-control">
          <option value="">Select Ward</option>
          <option *ngFor="let ward of wards" [value]="ward.code">{{ ward.name }}</option>
        </select>
      </div>
    </div>
    <div class="form-group">
      <label>Email</label>
      <input
        formControlName="email"
        class="form-control"
        [value]="user?.email"
        autocomplete="off"
      />
    </div>
  </ng-template>

  <div class="form-group">
    <label>Hình thức thanh toán</label>
    <select
      formControlName="typePayment"
      class="form-control"
      id="drTypePayment"
      (change)="onPaymentChange($event)"
    >
      <option value="1">COD</option>
      <option value="2">Chuyển khoản</option>
    </select>
  </div>

  <div class="form-group" id="load_form_payment" *ngIf="showVNPayOptions">
    <h4><label>Chọn phương thức thanh toán:</label></h4>
    <h5>Cách 1: Chuyển hướng sang VNPAY chọn phương thức thanh toán</h5>
    <label
      ><input type="radio" formControlName="typePaymentVN" value="0" /> Cổng thanh toán VNPAYQR
    </label>
    <h5>Cách 2: Tách phương thức thanh toán tại site của Merchant</h5>
    <label
      ><input type="radio" formControlName="typePaymentVN" value="1" /> Thanh toán qua ứng dụng hỗ
      trợ VNPAYQR </label
    ><br />
    <label
      ><input type="radio" formControlName="typePaymentVN" value="2" /> ATM-Tài khoản ngân hàng nội
      địa </label
    ><br />
    <label
      ><input type="radio" formControlName="typePaymentVN" value="3" /> Thanh toán qua thẻ quốc tế </label
    ><br />
  </div>

  <div id="loading" class="loading-spinner" *ngIf="loading"></div>

  <div class="form-group">
    <button
      type="submit"
      class="btn btn-block btn-success"
      [disabled]="checkoutForm.invalid"
      (click)="onSubmit()"
    >
      Đặt hàng
    </button>
  </div>
</form>
